<!DOCTYPE html>




    
    

<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link href="http://fonts.googleapis.com/css?family=Exo+2:700|Open+Sans:400italic,400&subset=latin,cyrillic" rel="stylesheet" type="text/css">
    <title>Allure PyTest integration</title>
    <meta name="viewport" content="width=device-width">

    <link  href="//yandex.st/bootstrap/3.0.2/css/bootstrap.min.css" rel="stylesheet">
    <link  href="//fotorama.s3.amazonaws.com/4.4.8/fotorama.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/syntax.css">
    <link rel="stylesheet" href="/css/main.css">

    <script src="//yandex.st/jquery/2.0.3/jquery.min.js"></script>
    <script src="//fotorama.s3.amazonaws.com/4.4.8/fotorama.js"></script>
</head>
<body>

<header class="header">
    <div class="container">
        <h1 class="title"><a href="/ru/">Allure Framework</a></h1>
        <ul class="menu">
            <li><a class="menu__title" href="/ru/">Главная</a></li>
            
            
            <li class="menu__menu java">
                
                <span class="menu__title">java</span>
                <ul class="dropdown">
                
                    <li class="dropdown__item"><a href="/ru/langs/java/junit.html">junit</a></li>
                
                    <li class="dropdown__item"><a href="/ru/langs/java/testng.html">testng</a></li>
                
                </ul>
            </li>
            
            <li class="menu__menu javascript">
                
                <span class="menu__title">javascript</span>
                <ul class="dropdown">
                
                    <li class="dropdown__item"><a href="/ru/langs/javascript/karma.html">karma</a></li>
                
                </ul>
            </li>
            
            <li class="menu__menu python">
                
                <span class="menu__title">python</span>
                <ul class="dropdown">
                
                    <li class="dropdown__item"><a href="/ru/langs/python/pytest.html">pytest</a></li>
                
                </ul>
            </li>
            
            <li>
                
                    <a class="menu__title" href="/">English Version</a>
                
            </li>
        </ul>
        <div class="pull-right">
            <a class="qatools" href="http://qatools.ru"></a>
        </div>
    </div>
</header>
<div class="page content container">
<h2>Allure-Pytest-Adaptor</h2>

<p>Плагин для <code>py.test</code> который может генерировать отчеты в удобочитаемом виде для <code>allure-report</code></p>

<h3>Usage</h3>
<div class="highlight"><pre><code class="text language-text" data-lang="text">py.test --alluredir [path_to_report_dir]
</code></pre></div>
<p>Плагин автоматически подключается к py.test через entry point, если установлен.</p>

<p>Подключение плагина в IDE:
<code>python
pytest_plugins = &#39;allure.adaptor&#39;,\
</code></p>

<h3>Advanced usage</h3>

<p>В плагине есть возможность генерировать данные сверх того, что делает pytest.</p>

<h4>Attachments</h4>

<p>Для того, чтобы сохранить что-нибудь в тесте:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pytest</span>

<span class="k">def</span> <span class="nf">test_foo</span><span class="p">():</span>
    <span class="n">pytest</span><span class="o">.</span><span class="n">allure</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="s">&#39;my attach&#39;</span><span class="p">,</span> <span class="s">&#39;Hello, World&#39;</span><span class="p">)</span>
</code></pre></div>
<h4>Steps</h4>

<p>Для того, чтобы побить тест на шаги:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pytest</span>

<span class="k">def</span> <span class="nf">test_foo</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">allure</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="s">&#39;step one&#39;</span><span class="p">):</span>
        <span class="c"># do stuff</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">allure</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="s">&#39;step two&#39;</span><span class="p">):</span>
        <span class="c"># do more stuff</span>
</code></pre></div>
<p>Работает и как декоратор:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pytest</span>

<span class="nd">@pytest.allure.step</span><span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">make_some_data</span><span class="p">():</span>
    <span class="c"># do stuff</span>

<span class="k">def</span> <span class="nf">test_foo</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">make_some_data</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
</code></pre></div>
<p>Для фикстур поддержка несколько ограничена.</p>

<h4>Severity</h4>

<p>Для тестов, модулей и классов можно задавать приоритеты:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pytest</span>

<span class="nd">@pytest.allure.severity</span><span class="p">(</span><span class="n">pytest</span><span class="o">.</span><span class="n">allure</span><span class="o">.</span><span class="n">severity_level</span><span class="o">.</span><span class="n">MINOR</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_minor</span><span class="p">():</span>
    <span class="k">assert</span> <span class="bp">False</span>


<span class="nd">@pytest.allure.severity</span><span class="p">(</span><span class="n">pytest</span><span class="o">.</span><span class="n">allure</span><span class="o">.</span><span class="n">severity_level</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">TestBar</span><span class="p">:</span>

    <span class="c"># will have CRITICAL priority</span>
    <span class="k">def</span> <span class="nf">test_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="c"># will have BLOCKER priority via a short-cut decorator</span>
    <span class="nd">@pytest.allure.BLOCKER</span>
    <span class="k">def</span> <span class="nf">test_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
</code></pre></div>
<p>Чтобы запустить тесты только определенных приоритетов:
<code>
py.test my_tests/ --allure_severities=critical,blocker
</code></p>

</div>

<footer class="footer">
    <div class="container">
        <span>
            <span class="contact">Allure Framework</span>
            <span class="contact">
                <a href="https://github.com/allure-framework">GitHub</a>
            </span>
            <span class="contact"><a href="mailto:allure@yandex-team.ru">allure@yandex-team.ru</a></span>
        </span>
        <div class="strut"></div>
    </div>
</footer>

</body>
</html>
